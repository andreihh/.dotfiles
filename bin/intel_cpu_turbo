#!/usr/bin/env bash

# Configures Turbo Boost if the CPU is Intel and supports it.

usage="Usage: $0 {get|on|off}"
[ $# -ne 1 ] && echo "$usage" && exit 1

turbo_config="/sys/devices/system/cpu/intel_pstate/no_turbo"
[ ! -f "$turbo_config" ] \
  && echo "Not an Intel CPU or Turbo Boost not supported!" \
  && exit 1

case "$1" in
  get)
    turbo_status=$(cat "$turbo_config")
    [ $(cat "$turbo_config") -eq 0 ] \
      && echo "Intel Turbo Boost is enabled." \
      || echo "Intel Turbo Boost is disabled."
    ;;
  on) echo "0" | sudo tee "$turbo_config" > /dev/null ;;
  off) echo "1" | sudo tee "$turbo_config" > /dev/null ;;
  *) echo "$usage" && exit 1 ;;
esac
