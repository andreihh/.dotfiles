" ~/.ideavimrc

source ~/.vimrc

" Enable ideajoin plugin.
set ideajoin

" Enable using the system clipboard from IdeaVIM and vice-versa.
set clipboard+=ideaput

" IDE actions.
" Ideally, these should all be noremap, but that's not currently supported.

" Autocomplete shortcuts:
" - Ctrl-Space (trigger)
" - Tab>/Shift-Tab (cycle through options)
" - Enter/Space (accept option)
" - Esc (reject option, via native IntelliJ command)
"imap <C-Space> <Action>(SmartTypeCompletion)
"imap <Tab> <Action>(EditorDown)
"imap <S-Tab> <Action>(EditorUp)
"imap <CR> <Action>(EditorChooseLookupItem)
"imap <Space> <Action>(EditorChooseLookupItemReplace)

" Window, tab, and pane control actions.
nmap <Leader>n <Action>(NewElement)
nmap <Leader>x <Action>(CloseContent)
nmap <Leader>h <Action>(NextTab)
nmap <Leader>l <Action>(PreviousTab)
nmap <Leader><Esc> <Action>(HideAllWindows)

" Code navigation and manipulation actions.
nmap <Leader>f <Action>(FindUsages)
nmap <Leader>q <Action>(QuickJavaDoc)
nmap <Leader>p <Action>(ParameterInfo)
nmap <Leader>r <Action>(RenameElement)
nmap <Leader>R <Action>(Refactorings.QuickListPopupAction)
nmap <Leader>m <Action>(Move)
nmap <Leader>d <Action>(GotoDeclaration)
nmap <Leader>g <Action>(GotoImplementation)
nmap <Leader>s <Action>(GotoSuperMethod)
nmap <Leader>j <Action>(Back)
nmap <Leader>k <Action>(Forward)
nmap <Leader>o <Action>(OptimizeImports)
nmap <Leader>= <Action>(ReformatCode)
nmap <Leader>- <Action>(ShowNavBar)
nmap <Leader><Tab> <Action>(SearchEverywhere)
nmap <Leader>` <Action>(RunAnything)
nmap [m <Action>(MethodUp)
nmap ]m <Action>(MethodDown)

" These actions must work in insert mode as well.
nmap <A-CR> <Action>(ShowIntentionActions)
nmap <C-Space> <Action>(SmartTypeCompletion)
" Currently, IdeaVIM doesn't properly return to insert mode when using the
" <Action>() syntax.
imap <A-CR> <C-o>:action ShowIntentionActions<CR>
imap <C-Space> <C-o>:action SmartTypeCompletion<CR>

" Tool window actions.
"
" Esc refocuses the editor and automatically closes undocked windows.
nmap <Leader>1 :NERDTreeFocus<CR>
nmap <Leader>2 <Action>(ActivateTerminalToolWindow)
nmap <Leader>3 <Action>(ActivateStructureToolWindow)
nmap <Leader>4 <Action>(ActivateFindToolWindow)
nmap <Leader>8 <Action>(ActivateRunToolWindow)
nmap <Leader>9 <Action>(ActivateDebugToolWindow)
nmap <F11> <Action>(ToggleFullScreen)

" Debugging actions.
nmap <F1> <Action>(ToggleLineBreakpoint)
nmap <F2> <Action>(ShowExecutionPoint)
nmap <F3> <Action>(StepOver)
nmap <F4> <Action>(StepInto)
nmap <F5> <Action>(StepOut)
nmap <F6> <Action>(RunToCursor)
nmap <F7> <Action>(EvaluateExpression)
nmap <F8> <Action>(Resume)
nmap <F9> <Action>(Stop)
nmap <F10> <Action>(ViewBreakpoints)

" IdeaVIM doesn't work when focusing tool windows, so their shortcuts need to be
" overridden in the IDE keymap as well:
" > File > Settings > Keymap
"   > Editor Actions (keep all conflicting mappings)
"     > Left: h
"     > Down: Tab, j
"     > Up: Shift-Tab, k
"     > Right: l
"     > Choose Lookup Item Replace: Space
"     > Choose Lookup Item: Enter
"   > Main Menu
"     > View > Appearance > Toggle Full Screen mode
"     > Window > Active Tool Window > Hide Active Tool Window
"   > Tool Windows
"
" Additionally, the IDE appearance should be customized as follows:
" > View
"   > Appearance:
"     > Main Menu: on
"     > Toolbar: off
"     > Navigation Bar: off
"     > Tool Window Bars: off
"     > Status Bar: on
"     > Status Bar Widgets: all on
"     > Details in Tree View: off
"     > Members in Navigation Bar: on
"   > Active Editor:
"     > Soft-Wrap: off
"     > Show Whitespaces: off
"     > Show Line Numbers: on
"     > Show Gutter Icons: on
"     > Show Breadcrumbs: off
"     > Show Indent Guides: on
"     > Show Import Popups: on
" > File > Settings
"   > Editor > General > Editor Tabs > Tab placement: None
"   > Tools > Terminal > Override IDE shortcuts: on
" > Tool Windows Sidebar
"   > Project: Left Top, Dock Pinned
"   > Structure: Left Bottom, Dock Unpinned
"   > Terminal | Find, Run: Bottom Left, Dock Unpinned
"   > Debug: Bottom Left, Dock Pinned
